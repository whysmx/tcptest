# tcptest

一个简单的 TCP 测试工具（命令行版），可作为 TCP 客户端或 TCP 服务端使用。支持菜单式配置，按固定间隔发送当前时间，并统计发送/接收次数。

## 功能特性

- 菜单选择 TCP 客户端 / TCP 服务端
- 客户端：每 5 秒发送一次当前时间，打印发送/接收次数
- 客户端：服务端断开后自动重连（每 3 秒重试）
- 服务端：收到数据后立即回发当前时间，打印发送/接收次数
- 默认监听 IP：回车即 `0.0.0.0`
- 默认监听端口：回车即 `5056`
- 客户端内置两个常用服务端地址，可选或自定义

## 运行环境

- Go 1.20+（本地运行/编译，兼容 Windows Server 2008 R2）
- Windows 产物通过 GitHub Actions 自动构建

## 本地运行

在项目根目录执行：

```bash
go run .
```

## 本地编译

```bash
go build -o tcptest .
```

## 使用说明

启动后会显示菜单：

1. TCP 客户端
   - 可选内置地址：
     - `10.41.100.54:5056`
     - `10.170.0.96:5056`
   - 或选择自定义输入 IP/端口
   - 连接成功后每 5 秒发送当前时间

2. TCP 服务端
   - 监听 IP：回车默认 `0.0.0.0`
   - 监听端口：回车默认 `5056`
   - 收到客户端数据后回发当前时间

运行过程中会显示发送/接收次数，例如：

```
发送 #3: 2026-02-06T12:34:56.789Z
接收 #3: 2026-02-06T12:34:56.790Z
```

按 `Ctrl+C` 退出。

## 日志

启动后会在当前目录生成日志文件，报文与错误会同时写入日志和控制台，文件名示例：

- `tcptest-client-20260206-123456.log`
- `tcptest-server-20260206-123456.log`

## GitHub Actions 自动打包

- 推送到 `main`：自动构建 Windows 版本并上传为构建产物
- 推送 tag（如 `v1.0.0`）：
  - 自动构建 Windows 版本
  - 自动创建 GitHub Release
  - 上传 `tcptest-<tag>.exe` 到 Release

## 自动版本号（main 分支）

推送到 `main` 时会自动创建 tag（默认补丁版本递增）：
- 如果仓库没有任何 tag，会创建 `v1.0.0`
- 之后每次 push 到 `main`，自动递增为 `v1.0.1`、`v1.0.2` ...

创建 tag 示例（可选，若你想手动指定版本）：

```bash
git tag v1.0.0
git push origin v1.0.0
```

## 目录结构

```
.
├── main.go
├── go.mod
└── .github/workflows
    ├── build.yml
    └── tag.yml
```

## 许可

如需添加 LICENSE，请告诉我你想用的协议（MIT / Apache-2.0 / GPL 等）。
